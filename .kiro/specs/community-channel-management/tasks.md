# 구현 계획

- [x] 1. 프로젝트 기본 구조 및 의존성 설정
  - Flutter 프로젝트 초기 설정 및 폴더 구조 생성
  - pubspec.yaml에 필요한 패키지 추가 (riverpod, firebase_core, firebase_auth, cloud_firestore, firebase_storage, firebase_messaging)
  - Firebase 프로젝트 설정 및 앱 연결
  - _요구사항: 1.1, 2.3_

- [ ] 2. 핵심 데이터 모델 및 Enum 정의
  - [x] 2.1 모든 Enum 클래스 구현
    - UserRole, UserStatus, EventStatus, ParticipationStatus 등 모든 상태 Enum 정의
    - 각 Enum에 대한 확장 메서드 구현 (한국어 표시명, 색상 등)
    - _요구사항: 12.1, 12.2, 12.3_

  - [x] 2.2 핵심 Entity 클래스 구현
    - User, Channel, Event, Settlement, Rule 등 핵심 엔티티 클래스 작성
    - JSON 직렬화/역직렬화 메서드 구현
    - 유효성 검사 메서드 추가
    - _요구사항: 1.2, 3.1, 4.1, 14.2_

- [ ] 3. Firebase 인증 시스템 구현
  - [x] 3.1 AuthService 인터페이스 및 구현체 작성
    - Google 로그인 기능 구현
    - Apple 로그인 기능 구현
    - 로그아웃 및 인증 상태 스트림 구현
    - _요구사항: 1.1, 2.2, 2.3_

  - [x] 3.2 고급 Riverpod 아키텍처 구조 설계 및 구현
    - BasePage 추상 클래스 구현 (HookConsumerWidget 상속)
    - 페이지별 State/Event Mixin Class 패턴 정의
    - ProviderScope를 활용한 페이지 Argument 관리 시스템 구현
    - UncontrolledProviderScope 및 전역 ProviderContainer 설정
    - Async Provider 안전 접근 패턴 정의
    - _고급 Riverpod 활용 지침 참조_

  - [x] 3.3 인증 관련 Riverpod Provider 구현
    - AuthProvider 및 관련 상태 관리 로직 작성
    - 인증 상태 변화에 따른 자동 리디렉션 로직
    - AuthState/AuthEvent Mixin Class 구현
    - _요구사항: 1.1, 2.3_

- [x] 4. 온보딩 및 로그인 UI 구현
  - [x] 4.1 로그인 화면 구현
    - Google/Apple 로그인 버튼이 있는 초기 화면 작성
    - 로딩 상태 및 에러 처리 UI 구현
    - _요구사항: 1.1, 2.2_

  - [x] 4.2 채널 생성 화면 구현
    - 모임 이름, 소개 입력 폼 작성
    - 채널 생성 완료 후 초대 링크 표시 화면
    - _요구사항: 1.2, 1.3, 1.4_

- [x] 5. 채널 관리 시스템 구현
  - [x] 5.1 ChannelRepository 인터페이스 및 Firestore 구현체 작성
    - 채널 생성, 조회, 업데이트 기능 구현
    - 초대 코드 생성 및 검증 로직
    - 멤버 관리 (추가, 제거, 권한 변경) 기능
    - _요구사항: 1.2, 1.3, 2.3, 6.2, 6.3_

  - [x] 5.2 채널 관련 Riverpod Provider 구현
    - ChannelProvider 및 상태 관리 로직 작성
    - ChannelState/ChannelEvent Mixin Class 구현
    - 사용자별 채널 목록 관리
    - 채널 Argument Provider 구현 (ProviderScope 활용)
    - _요구사항: 1.2, 2.3_

- [x] 6. 메인 네비게이션 구조 구현
  - [x] 6.1 바텀 네비게이션 바 구현
    - "나의 벙", "전체 벙 일정", "설정" 3개 탭 구조 작성
    - 탭 간 상태 유지 및 전환 로직
    - _요구사항: 9.1, 9.2_

  - [x] 6.2 플로팅 액션 버튼 구현
    - 모든 화면에서 접근 가능한 "벙 만들기" FAB 추가
    - 벙 생성 화면으로의 네비게이션 로직
    - _요구사항: 3.3, 8.1_

- [x] 7. 벙(이벤트) 관리 시스템 구현
  - [x] 7.1 EventRepository 인터페이스 및 Firestore 구현체 작성
    - 벙 생성, 조회, 업데이트, 삭제 기능 구현
    - 참여/취소 로직 및 대기열 관리
    - 벙 상태 자동 변경 로직 (시간 기반)
    - _요구사항: 8.2, 8.3, 4.3, 4.4, 12.1, 12.2, 12.4_

  - [x] 7.2 벙 관련 Riverpod Provider 구현
    - EventProvider 및 상태 관리 로직 작성
    - EventState/EventEvent Mixin Class 구현
    - 실시간 벙 목록 업데이트 (Firestore 스트림)
    - 벙 상세 Argument Provider 구현
    - Async Provider .future 패턴 적용
    - _요구사항: 3.1, 3.2, 4.1, 4.2_

- [x] 8. 벙 생성 및 관리 UI 구현
  - [x] 8.1 벙 생성 화면 구현
    - 벙 이름, 설명, 날짜/시간, 장소, 최대 인원 입력 폼
    - 정산 필요 여부 선택 옵션
    - 유효성 검사 및 에러 처리 UI
    - _요구사항: 8.1, 8.2, 13.1, 13.2_

  - [x] 8.2 벙 상세 화면 구현
    - BasePage를 상속받는 EventDetailPage 구현
    - 벙 정보 표시 및 참여/취소 버튼
    - 참여자 목록 및 대기자 목록 표시
    - 벙주 전용 관리 기능 (수정, 마감, 취소)
    - EventDetailState/EventDetailEvent Mixin Class 활용
    - _요구사항: 4.3, 4.4, 8.4, 8.5, 12.2, 12.6_

- [x] 9. "나의 벙" 탭 구현
  - [x] 9.1 참여 벙 목록 화면 구현
    - 사용자가 참여하거나 대기 중인 벙 목록 표시
    - 시간순 정렬 및 상태별 필터링 기능
    - _요구사항: 3.1, 3.4_

  - [x] 9.2 개설 벙 목록 화면 구현
    - 사용자가 개설한 벙 목록 및 참여 현황 표시
    - 벙 관리 기능 (수정, 마감, 취소) 접근
    - _요구사항: 3.2, 3.4_

- [x] 10. "전체 벙 일정" 탭 구현
  - 채널 내 모든 공개 벙 목록 화면 구현
  - 최신순/날짜순 정렬 옵션
  - 벙 검색 및 필터링 기능
  - _요구사항: 4.1, 4.2_

- [x] 11. 정산 시스템 구현
  - [x] 11.1 SettlementRepository 인터페이스 및 Firestore 구현체 작성
    - 정산 생성, 조회, 업데이트 기능 구현
    - 입금 상태 관리 및 완료 처리 로직
    - _요구사항: 14.2, 14.3, 15.3, 16.2_

  - [x] 11.2 정산 관리 UI 구현
    - 벙주용 정산 생성 화면 (계좌 정보, 비용 내역 입력)
    - 영수증 첨부 기능 (Firebase Storage 연동)
    - 입금 상태 확인 및 완료 처리 화면
    - _요구사항: 14.1, 14.2, 14.4, 16.1, 16.3_

  - [x] 11.3 참여자용 정산 화면 구현
    - 정산 내역 확인 화면
    - 입금 완료 알림 기능
    - _요구사항: 15.1, 15.2_

- [x] 12. 설정 화면 구현
  - [x] 12.1 일반 사용자 설정 화면 구현
    - 프로필 편집 (닉네임 변경) 기능
    - 알림 설정 (푸시 알림 On/Off)
    - 로그아웃 및 회원 탈퇴 기능
    - _요구사항: 5.1, 5.2, 5.3, 5.4_

  - [x] 12.2 관리자 전용 모임 관리 화면 구현
    - 멤버 관리 (목록 조회, 검색, 강제 탈퇴, 활동 제한)
    - 공지사항 발송 기능
    - 모임 정보 수정 및 초대 링크 재생성
    - _요구사항: 6.1, 6.2, 6.3, 6.4, 6.5, 6.6_

- [x] 13. 푸시 알림 시스템 구현
  - [x] 13.1 NotificationService 인터페이스 및 FCM 구현체 작성
    - 다양한 알림 타입별 메시지 생성 로직
    - 대상 사용자 필터링 및 일괄 전송 기능
    - _요구사항: 7.1, 7.2, 7.3, 7.4_

  - [x] 13.2 알림 수신 및 처리 로직 구현
    - 앱 상태별 알림 처리 (foreground, background, terminated)
    - 전역 ProviderContainer를 통한 WidgetRef 없는 곳에서의 상태 변경
    - 알림 클릭 시 해당 화면으로 네비게이션
    - 알림 설정 존중 로직
    - _요구사항: 7.5_

- [x] 14. 회칙 관리 시스템 구현
  - [x] 14.1 RuleRepository 인터페이스 및 Firestore 구현체 작성
    - 회칙 생성, 조회, 업데이트 기능 구현
    - Google Datastore 연동 (Vertex AI Search용)
    - _요구사항: 10.2, 10.3, 10.4_

  - [x] 14.2 관리자용 회칙 관리 화면 구현
    - 회칙 작성/편집 텍스트 에디터
    - 회칙 저장 및 업데이트 알림 기능
    - _요구사항: 10.1, 10.2, 10.5_

- [ ] 15. AI 챗봇 시스템 구현
  - [ ] 15.1 ChatbotService 인터페이스 및 Vertex AI Search 구현체 작성
    - Vertex AI Search API 연동
    - 질문 처리 및 답변 생성 로직
    - 대화 내역 저장 기능
    - _요구사항: 11.3, 11.4, 11.6_

  - [ ] 15.2 챗봇 UI 구현
    - 대화형 채팅 인터페이스
    - 질문 입력 및 답변 표시 화면
    - 답변을 찾을 수 없을 때 안내 메시지
    - _요구사항: 11.1, 11.2, 11.5_

- [x] 16. 에러 처리 및 예외 관리 구현
  - 전역 에러 핸들러 및 사용자 친화적 에러 메시지 시스템 구현
  - 네트워크 에러 재시도 로직 및 오프라인 모드 지원
  - 로깅 시스템 구현 (Firebase Crashlytics 연동)
  - _설계 문서의 에러 처리 전략 참조_

- [ ] 17. 성능 최적화 및 캐싱 구현
  - 이미지 캐싱 및 압축 로직 구현
  - Riverpod을 활용한 메모리 캐싱 최적화
  - 페이지네이션 및 무한 스크롤 구현
  - _설계 문서의 성능 최적화 방안 참조_

- [x] 18. 보안 강화 및 Firestore Rules 설정
  - Firestore 보안 규칙 작성 및 배포
  - 사용자 입력 검증 및 sanitization 로직 구현
  - 민감 정보 암호화 처리 (계좌 정보 등)
  - _설계 문서의 보안 고려사항 참조_

- [ ] 19. 테스트 코드 작성
  - [ ] 19.1 Unit Test 작성
    - Repository 구현체 테스트
    - Use Case 로직 테스트
    - 유틸리티 함수 테스트
    - _설계 문서의 테스트 전략 참조_

  - [ ] 19.2 Widget Test 작성
    - 주요 UI 컴포넌트 테스트
    - 사용자 상호작용 테스트
    - 상태 변화 테스트
    - _설계 문서의 테스트 전략 참조_

- [ ] 20. Riverpod 아키텍처 최적화 및 리팩토링
  - 모든 페이지를 BasePage 패턴으로 리팩토링
  - State/Event Mixin Class 패턴 일관성 검토
  - ProviderScope Argument 관리 시스템 전체 적용
  - Async Provider .future 패턴 전체 적용
  - 전역 ProviderContainer 활용 최적화
  - _고급 Riverpod 활용 지침 전체 검토_

- [ ] 21. 최종 통합 테스트 및 배포 준비
  - 전체 기능 통합 테스트 수행
  - 앱 아이콘, 스플래시 스크린 등 최종 UI 요소 적용
  - 앱 스토어 배포를 위한 메타데이터 및 스크린샷 준비
  - _설계 문서의 배포 전략 참조_